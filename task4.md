# ДЗ №4

## Задача 1. RMSNorm

Реализуйте слой RMSNorm по статье https://arxiv.org/pdf/1910.07467 .

* Реализуйте расчёт RMS на PyTorch
* Добавьте обучаемый Parameter для масштабов
* Реализуйте `forward`, который выполняет RMSNorm

Проверьте правильность реализованного слоя, сравнив его результаты с RMSNorm из PyTorch: https://docs.pytorch.org/docs/stable/generated/torch.nn.RMSNorm.html .

## Задача 2. AutoGrad

Реализуйте AutoGrad Function для бинарной операции: `e^X + cos(Y)`. 

По возможности используйте `save_for_backward`, если нужно переиспользовать какие-то вычисления между forward и backward. 

Проверьте правильность реализованной операции, сравнив её результат (forward и градиенты) с результатом, полученным без кастомной функции. 

## Задача 3. Lion

Реализуйте оптимизатор Lion по статье: https://arxiv.org/pdf/2302.06675 .

Псевдокод оптимизатора из статьи:

```python
def train(weight, gradient, momentum, lr):
    update = interp(gradient, momentum, β1)
    update = sign(update)
    momentum = interp(gradient, momentum, β2)
    weight_decay = weight * λ
    update = update + weight_decay
    update = update * lr
    return update, momentum
```

Пояснения к функциям:

* `interp(x, y, a)` - линейная интерполяция `(1 - a) * x + a * y`
* `sign` - операции знака: 1 если положительное число, 0 если 0, -1 если отрицательное число.

Проверьте работоспособность оптимизатора, попробовав обучить с помощью него какую-нибудь модель (например, модель из первой домашки).

## Сдача

Код для воспроизведения результатов (чтобы можно было запустить разные .py-файлы и воспроизвести результаты) в виде ссылки на GitHub репозиторий нужно отправить мне в личку в телеграм.

### Баллы
* Выполнена любая одна задача: 3
* Выполнены любые две задачи: 4
* Выполнены все три задачи: 5

### Дедлайн

Сдавать и корректировать решение можно до 25 мая.
